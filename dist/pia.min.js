/**!
 * Pia JS v0.0.4
 * @author phucbm
 * @homepage https://github.com/phucbm/pia
 * @license MIT 2023
 */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,(()=>(()=>{"use strict";var e={r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e){return Date.parse("string"==typeof e?e:e.toString())}function o(e,t,o){return Math.floor(function(e,t){return n(t)-n(e)}(e,t)/function(e=""){const t=36e5,n={second:1e3,minute:6e4,hour:t,day:24*t,year:31536e6};return["year","day","hour","minute","second"].includes(e)?n[e]:n}(o))}function r(e){if(!e)return!0;return!["session","never"].includes(e.expires)&&function(e){const t=s(e);if(null===t)return!1;const n=e.expires;return t>n}(e)}function s(e,t=void 0){t=t||e.unit;return["ms","second","minute","hour","day"].includes(t)?o(new Date(e.createdDate),new Date,t):null}function u(e,t,n={}){const o={expires:"never",unit:"day",...n},r=function(e){return["hour","day"].includes(e)?e:(console.warn(`PiaJS: unit "${e}" is not recognized.`),!1)}(o.unit),s=function(e,t){if("string"==typeof e)return["session","tab","current-tab"].includes(e)?"session":"never";return"number"==typeof e&&parseInt(e)}(o.expires),u=function(e){return"session"===e?"sessionStorage":"localStorage"}(s);return{key:e,valueType:typeof t,value:t,expires:s,unit:r,storageType:u,arguments,createdDate:(new Date).toString()}}function i(e,t){const n=t.storageType,o=JSON.stringify(t);a(e)?.storageType!==n&&c(e),"sessionStorage"===n?sessionStorage.setItem(e,o):localStorage.setItem(e,o)}function a(e,t=!1){let n=localStorage.getItem(e);if(null===n&&(n=sessionStorage.getItem(e)),null===n)return n;const o=JSON.parse(n);return r(o)?(c(o.key,o.storageType),null):t?o:o.value}function c(e,t="localStorage"){"sessionStorage"===t?sessionStorage.removeItem(e):localStorage.removeItem(e)}e.r(t);return window.Pia=new class{constructor(){}isExpired(e){return r(a(e))}update(e,t){if(!a(e))return void console.warn(`Updating undefined record "${e}" is not allowed.`);const n=a(e,!0);typeof t!==n.valueType&&console.warn(`Updating mismatched value types. Changing from ${n.valueType} to ${typeof t}.`),n.value=t,i(e,n)}set(e,t,n={}){i(e,u(e,t,n))}get(e,t=!1){return a(e,t)}remove(e){return c(e)}test(e,t=!1){const n=a(e,!0);let o;const r=[];return n?("number"==typeof n.expires?(r.push(`${n.expires-s(n)} ${n.unit}(s) left`),["second","minute","hour","day"].forEach((e=>{r.push(`created ${s(n,e)} ${e}(s) ago`)}))):r.push(n.expires),o={leftover:r,record:n}):o=`Record "${e}" not found.`,t&&(console.group("Test record:",e),console.table(r),console.log("record",n),console.groupEnd()),o}},t})()));